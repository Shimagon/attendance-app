# 📊 スプレッドシート自動セットアップガイド

## 🚀 クイックセットアップ（3分で完了）

### ステップ1: スプレッドシートを開く

```
https://docs.google.com/spreadsheets/d/1MaCsDpwYOtNn8hqywq300hThzMIXOhPnkS6LvcUskuk/edit
```

### ステップ2: Apps Scriptエディタを開く

1. メニューから **拡張機能** > **Apps Script** をクリック

### ステップ3: セットアップスクリプトを追加

1. 左側のファイル一覧で **+** ボタンをクリック > **スクリプト** を選択
2. ファイル名を「setup」に変更
3. `setup-spreadsheet.js` の内容を全てコピー&ペースト
4. **保存** (💾) をクリック

### ステップ4: セットアップを実行

1. 関数選択で **setupSpreadsheet** を選択
2. **実行** ボタン (▶️) をクリック
3. 権限の確認が出たら:
   - **権限を確認** をクリック
   - Googleアカウントを選択
   - **詳細** をクリック
   - **安全でないページに移動** をクリック
   - **許可** をクリック

### ステップ5: 完了確認

実行ログに以下が表示されればOK:

```
✅ スプレッドシートのセットアップが完了しました
📊 作成されたシート:
  - 研修生マスタ
  - 打刻記録
  - 課題完了記録
```

スプレッドシートに戻ると、3つのシートが自動生成されています！

---

## 📋 生成されるシート構成

### シート1: 研修生マスタ

| 研修生ID | 氏名 | ステータス |
|---------|------|----------|
| user01  | あなたの名前 | 進行中 |

- 背景色: 青 (#4A90E2)
- サンプルデータ1行付き

### シート2: 打刻記録

| 日付 | 研修生ID | 氏名 | 出勤時刻 | 退勤時刻 | 勤務時間 |
|------|---------|------|---------|---------|---------|

- 背景色: 緑 (#5CB85C)
- 日付列は `yyyy-mm-dd` 形式

### シート3: 課題完了記録

| 完了日時 | 研修生ID | 氏名 | アプリURL | 判定 |
|---------|---------|------|---------|------|

- 背景色: オレンジ (#F0AD4E)
- 判定列はドロップダウン（合格/不合格/保留）

---

## 🔧 メインスクリプトをデプロイ

セットアップが完了したら、メインの `google-apps-script.js` をデプロイします。

### ステップ1: メインスクリプトを追加

1. Apps Scriptエディタで `コード.gs` を開く
2. 既存の内容を全て削除
3. `google-apps-script.js` の内容を全てコピー&ペースト
4. **保存** をクリック

### ステップ2: デプロイ

1. **デプロイ** > **新しいデプロイ** をクリック
2. **歯車アイコン** ⚙️ > **ウェブアプリ** を選択
3. 設定:
   - 説明: 勤怠管理API v1
   - 次のユーザーとして実行: **自分**
   - アクセスできるユーザー: **全員**
4. **デプロイ** をクリック
5. **ウェブアプリURL** をコピー

### ステップ3: アプリに設定

デプロイURLは既に設定済みです：
```javascript
APPS_SCRIPT_URL: 'https://script.google.com/macros/s/AKfycbzcQ7XriEVHqwTChmeu97cjB1BFOZMP0VyfZYbNdW0swX5IwIiVCujxYcCsLQQJ-fxuIw/exec'
```

---

## 🧪 テスト

### Apps Scriptエディタでテスト

1. 関数選択で **testClockIn** を選択
2. **実行** をクリック
3. スプレッドシートの「打刻記録」シートにデータが追加されることを確認

同様に:
- **testClockOut** - 退勤記録をテスト
- **testTaskComplete** - 課題完了をテスト

---

## 🔄 データをリセット

データを削除して初期状態に戻したい場合:

1. Apps Scriptエディタで **setup** ファイルを開く
2. 関数選択で **clearAllData** を選択
3. **実行** をクリック

全データが削除され、サンプルデータのみ残ります。

---

## 🔍 シート構成を確認

現在のシート構成を確認:

1. 関数選択で **checkSheets** を選択
2. **実行** をクリック
3. 実行ログで各シートの行数・列数を確認

---

## ❌ トラブルシューティング

### エラー: シートが見つかりません

**原因**: シートが正しく作成されていない

**解決策**: `setupSpreadsheet()` を再実行

### エラー: 権限エラー

**原因**: スプレッドシートへのアクセス権限がない

**解決策**:
1. 任意の関数を実行
2. 権限の確認を求められたら「許可」

### データが記録されない

**チェック項目**:
1. シート名が正確か確認（完全一致が必要）
2. デプロイURLが正しいか確認
3. `checkSheets()` で構成を確認

---

## 📝 手動でシートを作成する場合

自動セットアップがうまくいかない場合、手動で作成:

### 研修生マスタ

```
A1: 研修生ID
B1: 氏名
C1: ステータス

A2: user01
B2: あなたの名前
C2: 進行中
```

### 打刻記録

```
A1: 日付
B1: 研修生ID
C1: 氏名
D1: 出勤時刻
E1: 退勤時刻
F1: 勤務時間
```

### 課題完了記録

```
A1: 完了日時
B1: 研修生ID
C1: 氏名
D1: アプリURL
E1: 判定
```

**重要**: シート名は完全一致が必要です！

---

**作成日**: 2025-11-29
**スプレッドシートID**: 1MaCsDpwYOtNn8hqywq300hThzMIXOhPnkS6LvcUskuk
